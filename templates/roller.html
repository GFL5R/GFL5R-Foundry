<section class="container-fluid py-3">

  <header class="card mb-3">
    <div class="card-body d-flex flex-wrap justify-content-between align-items-center gap-2">
      <div class="fw-semibold">
        <strong>{{skillLabel}}</strong> via <em>{{approachName}}</em>
        {{#if hiddenTN}}
          · <span title="Hidden TN">Hidden TN</span>
        {{else}}
          · TN {{tn}}
        {{/if}}
        · Keep {{kept.length}} / {{keepLimit}}
      </div>
      <div class="btn-group">
        <button type="button" class="btn btn-primary" data-action="continue-roll">Continue</button>
        <button type="button" class="btn btn-success" data-action="finish-roll">Finish</button>
        <button type="button" class="btn btn-outline-secondary" data-action="cancel-roll">Cancel</button>
      </div>
    </div>
  </header>

  <div class="card mb-3">
    <div class="card-body">
      <h2 class="h6 mb-3">Pool</h2>
      <div class="d-flex flex-wrap gap-2" data-zone="pool">
        {{#each pool as |d|}}
          <div class="border rounded p-1 bg-light" draggable="true" data-die-id="{{d.id}}" title="{{d.label}}">
            <img src="{{d.icon}}" alt="{{d.label}}" style="width:36px; height:36px;" />
            {{#if d._fromExplosion}}<span class="ms-1 text-warning">✨</span>{{/if}}
          </div>
        {{/each}}
      </div>
    </div>
  </div>

  <div class="row g-3">
    <div class="col-md-4">
      <div class="card h-100">
        <div class="card-body">
          <h2 class="h6 mb-3">Keep</h2>
          <div class="d-flex flex-wrap gap-2" data-zone="keep">
            {{#each kept as |d|}}
              <div class="border rounded p-1 bg-light" draggable="true" data-die-id="{{d.id}}" title="{{d.label}}">
                <img src="{{d.icon}}" alt="{{d.label}}" style="width:36px; height:36px;" />
                {{#if d._fromExplosion}}<span class="ms-1 text-warning">✨</span>{{/if}}
              </div>
            {{/each}}
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card h-100">
        <div class="card-body">
          <h2 class="h6 mb-3">Reroll</h2>
          <div class="d-flex flex-wrap gap-2" data-zone="reroll">
            {{#each toReroll as |d|}}
              <div class="border rounded p-1 bg-light" draggable="true" data-die-id="{{d.id}}" title="{{d.label}}">
                <img src="{{d.icon}}" alt="{{d.label}}" style="width:36px; height:36px;" />
                {{#if d._fromExplosion}}<span class="ms-1 text-warning">✨</span>{{/if}}
              </div>
            {{/each}}
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card h-100">
        <div class="card-body">
          <h2 class="h6 mb-3">Discard</h2>
          <div class="d-flex flex-wrap gap-2" data-zone="discard">
            {{#each discarded as |d|}}
              <div class="border rounded p-1 bg-light" draggable="true" data-die-id="{{d.id}}" title="{{d.label}}">
                <img src="{{d.icon}}" alt="{{d.label}}" style="width:36px; height:36px;" />
                {{#if d._fromExplosion}}<span class="ms-1 text-warning">✨</span>{{/if}}
              </div>
            {{/each}}
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="card mt-3">
    <div class="card-body d-flex flex-wrap gap-4">
      <div><strong>Successes:</strong> {{tally.s}}</div>
      <div><strong>Opportunity:</strong> {{tally.o}}</div>
      <div><strong>Strife:</strong> {{tally.r}}</div>
    </div>
  </div>

</section>
