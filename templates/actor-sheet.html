<form class="gfl5r actor-sheet" autocomplete="off">

  <!-- HEADER -->
  <header class="sheet-header">
    <div class="flexrow">
      <img class="profile-img" src="{{actor.img}}" data-edit="img" title="{{actor.name}}"
        style="width:80px; height:80px;" />

      <div class="header-fields" style="flex:1;">
        <h1>
          <input name="name" type="text" value="{{actor.name}}" placeholder="Character Name"/>
        </h1>

        <div class="grid" style="grid-template-columns: repeat(2, 1fr);">
          <div class="form-group">
            <label>Humanity</label>
            <input type="number" name="system.humanity" value="{{actor.system.humanity}}" min="0"/>
          </div>
          <div class="form-group">
            <label>Fame</label>
            <input type="number" name="system.fame" value="{{actor.system.fame}}" min="0"/>
          </div>
        </div>
      </div>
    </div>
  </header>
  
  <!-- APPROACHES + STATE -->
  <section class="approach-state-wrapper" style="display:flex; gap:40px; margin-bottom:16px;">

    <!-- LEFT: Approaches -->
    <div class="approaches-section card" style="flex:1;">
      <h2>Approaches</h2>
      <div class="grid" style="grid-template-columns: 1fr;">
        <div class="form-group vertical">
          <label>Power</label>
          <input type="number" name="system.approaches.power" value="{{actor.system.approaches.power}}" min="0"/>
        </div>
        <div class="form-group vertical">
          <label>Swiftness</label>
          <input type="number" name="system.approaches.swiftness" value="{{actor.system.approaches.swiftness}}" min="0"/>
        </div>
        <div class="form-group vertical">
          <label>Resilience</label>
          <input type="number" name="system.approaches.resilience" value="{{actor.system.approaches.resilience}}" min="0"/>
        </div>
        <div class="form-group vertical">
          <label>Precision</label>
          <input type="number" name="system.approaches.precision" value="{{actor.system.approaches.precision}}" min="0"/>
        </div>
        <div class="form-group vertical">
          <label>Fortune</label>
          <input type="number" name="system.approaches.fortune" value="{{actor.system.approaches.fortune}}" min="0"/>
        </div>
      </div>
    </div>

    <!-- RIGHT: State -->
    <div class="state-section card" style="flex:1;">
      <h2 style="text-align:right;">State</h2>
      <div class="grid" style="grid-template-columns: 1fr; justify-items:end;">
        
        <div class="form-group">
          <div class="flexrow" style="justify-content:flex-end;">
            <label>Fatigue</label>
            <input type="number" name="system.resources.fatigue" value="{{actor.system.resources.fatigue}}" min="0" style="width:70px; text-align:right;"/>
            <span>/</span>
            <label>Endurance</label>
            <input type="text" value="{{derived.endurance}}" disabled style="width:70px; text-align:right;"/>
          </div>
        </div>

        <div class="form-group">
          <div class="flexrow" style="justify-content:flex-end;">
            <label>Strife</label>
            <input type="number" name="system.resources.strife" value="{{actor.system.resources.strife}}" min="0" style="width:70px; text-align:right;"/>
            <span>/</span>
            <label>Composure</label>
            <input type="text" value="{{derived.composure}}" disabled style="width:70px; text-align:right;"/>
          </div>
        </div>

        <div class="form-group">
          <label>Vigilance</label>
          <input type="text" value="{{derived.vigilance}}" disabled style="width:80px; text-align:right;"/>
        </div>

        <div class="form-group">
          <label>Focus</label>
          <input type="text" value="{{derived.focus}}" disabled style="width:80px; text-align:right;"/>
        </div>

        <div class="form-group">
          <label>Fortune Points</label>
          <div class="flexrow" style="justify-content:flex-end;">
            <input type="number" name="system.resources.fortunePoints" value="{{actor.system.resources.fortunePoints}}" min="0" style="width:70px; text-align:right;"/>
            <span>/</span>
            <input type="text" value="{{derived.fortunePointsMax}}" disabled style="width:70px; text-align:right;"/>
          </div>
        </div>

      </div>
    </div>

  </section>

  <!-- TABS -->
  <nav class="tabs sheet-tabs" data-group="primary">
    <a class="item" data-tab="skills">Skills</a>
    <a class="item" data-tab="narrative">Narrative</a>
  </nav>

  <!-- BODY -->
  <section class="sheet-body">
  
    <!-- SKILLS TAB -->
    <section class="tab" data-group="primary" data-tab="skills">
      <div class="grid" style="grid-template-columns: 2fr 1fr; align-items:start;">
    
        <!-- LEFT: SKILLS -->
        <div class="skills-column">
    
          <!-- Combat Skills -->
          <div class="card">
            <h2>Combat Skills</h2>
            <div class="grid" style="grid-template-columns: repeat(5, 1fr);">
              {{#each (object
                "blades" "Blades"
                "firearms" "Firearms"
                "handToHand" "Hand-To-Hand"
                "explosives" "Explosives"
                "tactics" "Tactics") as |label key|}}
                <div class="form-group vertical" title="{{label}}">
                  <label class="gfl-skill-label" data-skill="{{key}}">{{label}}</label>
                  <input type="number" name="system.skills.{{key}}" value="{{lookup ../actor.system.skills key}}" min="0"/>
                </div>
              {{/each}}
            </div>
          </div>
    
          <!-- Fieldcraft Skills -->
          <div class="card">
            <h2>Fieldcraft Skills</h2>
            <div class="grid" style="grid-template-columns: repeat(5, 1fr);">
              {{#each (object
                "athletics" "Athletics"
                "stealth" "Stealth"
                "survival" "Survival"
                "centering" "Centering"
                "insight" "Insight") as |label key|}}
                <div class="form-group vertical" title="{{label}}">
                  <label class="gfl-skill-label" data-skill="{{key}}">{{label}}</label>
                  <input type="number" name="system.skills.{{key}}" value="{{lookup ../actor.system.skills key}}" min="0"/>
                </div>
              {{/each}}
            </div>
          </div>
    
          <!-- Technical Skills -->
          <div class="card">
            <h2>Technical Skills</h2>
            <div class="grid" style="grid-template-columns: repeat(5, 1fr);">
              {{#each (object
                "mechanics" "Mechanics"
                "computers" "Computers"
                "medicine" "Medicine"
                "piloting" "Piloting"
                "subterfuge" "Subterfuge") as |label key|}}
                <div class="form-group vertical" title="{{label}}">
                  <label class="gfl-skill-label" data-skill="{{key}}">{{label}}</label>
                  <input type="number" name="system.skills.{{key}}" value="{{lookup ../actor.system.skills key}}" min="0"/>
                </div>
              {{/each}}
            </div>
          </div>
    
          <!-- Social & Cultural Skills -->
          <div class="card">
            <h2>Social & Cultural Skills</h2>
            <div class="grid" style="grid-template-columns: repeat(5, 1fr);">
              {{#each (object
                "command" "Command"
                "negotiation" "Negotiation"
                "deception" "Deception"
                "performance" "Performance"
                "culture" "Culture") as |label key|}}
                <div class="form-group vertical" title="{{label}}">
                  <label class="gfl-skill-label" data-skill="{{key}}">{{label}}</label>
                  <input type="number" name="system.skills.{{key}}" value="{{lookup ../actor.system.skills key}}" min="0"/>
                </div>
              {{/each}}
            </div>
          </div>

        </div>
    
        <!-- RIGHT: ABILITIES -->
        <aside class="abilities-column">
          <div class="card">
            <h2>Abilities</h2>
            
            <div class="gfl-drop-zone" data-drop-target="abilities" title="Drag & drop ability Items here">
              <div class="gfl-drop-zone__hint">Drop ability items here</div>
            </div>
      
            <div class="gfl-ability-list">
              {{#if abilities.length}}
                {{#each abilities as |ab|}}
                  <div class="gfl-ability-row" data-item-id="{{ab.id}}">
                    <img src="{{ab.img}}" alt="" />
                    <div class="gfl-ability-meta">
                      <div class="gfl-ability-name">{{ab.name}}</div>
                    </div>
                    <a class="gfl-ability-delete" data-item-id="{{ab.id}}" title="Remove ability">
                      <i class="fas fa-trash"></i>
                    </a>
                  </div>
                {{/each}}
              {{else}}
                <div class="gfl-ability-empty">No abilities yet.</div>
              {{/if}}
            </div>
          </div>
        </aside>

      </div>
    </section>

    <!-- NARRATIVE TAB -->
    <section class="tab" data-group="primary" data-tab="narrative">
      <div class="grid" style="grid-template-columns: 1fr 1fr; gap:20px; align-items:start;">
        
        <!-- LEFT: NARRATIVE ITEMS -->
        <div class="narrative-items-column">
          
          <!-- Distinctions and Passions -->
          <div class="card" style="margin-bottom:20px;">
            <h2>Distinctions and Passions</h2>
            
            <div class="gfl-drop-zone" data-drop-target="narrative-positive" title="Drag & drop Distinction or Passion items here">
              <div class="gfl-drop-zone__hint">Drop Distinction/Passion items here</div>
            </div>
      
            <div class="gfl-narrative-list">
              {{#if narrativePositive.length}}
                {{#each narrativePositive as |item|}}
                  <div class="gfl-ability-row" data-item-id="{{item.id}}">
                    <img src="{{item.img}}" alt="" />
                    <div class="gfl-ability-meta">
                      <div class="gfl-ability-name">{{item.name}}</div>
                      <div style="font-size:0.85em; opacity:0.8;">{{item.system.approach}} - {{item.system.narrativeType}}</div>
                    </div>
                    <a class="gfl-ability-delete" data-item-id="{{item.id}}" title="Remove item">
                      <i class="fas fa-trash"></i>
                    </a>
                  </div>
                {{/each}}
              {{else}}
                <div class="gfl-ability-empty">No distinctions or passions yet.</div>
              {{/if}}
            </div>
          </div>

          <!-- Adversities and Anxieties -->
          <div class="card">
            <h2>Adversities and Anxieties</h2>
            
            <div class="gfl-drop-zone" data-drop-target="narrative-negative" title="Drag & drop Adversity or Anxiety items here">
              <div class="gfl-drop-zone__hint">Drop Adversity/Anxiety items here</div>
            </div>
      
            <div class="gfl-narrative-list">
              {{#if narrativeNegative.length}}
                {{#each narrativeNegative as |item|}}
                  <div class="gfl-ability-row" data-item-id="{{item.id}}">
                    <img src="{{item.img}}" alt="" />
                    <div class="gfl-ability-meta">
                      <div class="gfl-ability-name">{{item.name}}</div>
                      <div style="font-size:0.85em; opacity:0.8;">{{item.system.approach}} - {{item.system.narrativeType}}</div>
                    </div>
                    <a class="gfl-ability-delete" data-item-id="{{item.id}}" title="Remove item">
                      <i class="fas fa-trash"></i>
                    </a>
                  </div>
                {{/each}}
              {{else}}
                <div class="gfl-ability-empty">No adversities or anxieties yet.</div>
              {{/if}}
            </div>
          </div>

        </div>

        <!-- RIGHT: BACKSTORY -->
        <div class="backstory-column">
          
          <div class="card" style="margin-bottom:20px;">
            <h2>Backstory</h2>
            <div class="form-group">
              <textarea name="system.backstory" rows="12" style="width:100%; resize:vertical;">{{actor.system.backstory}}</textarea>
            </div>
          </div>

          <div class="card">
            <h2>Notes</h2>
            <div class="form-group">
              <textarea name="system.notes" rows="12" style="width:100%; resize:vertical;">{{actor.system.notes}}</textarea>
            </div>
          </div>

        </div>

      </div>
    </section>
  
  </section>

</form>
